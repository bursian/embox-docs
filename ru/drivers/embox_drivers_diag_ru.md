
### Диагностический интерфейс
#### Описание
Диагностический интерфейс представляет из себя простейшее устройство позволяющее получить вывод на очень раннем этапе загрузки системы с помощью функций printk() и различных функций логирования (log_error(), log_info(), log_debug(). Также может быть преобразовано в простейшее устройство ввода вывода, которое позволяет вводить команды в консоли. Работает без прерываний.

* Устройство диагностического интерфейса может быть только одно в системе
* Устройство диагностического интерфейса представляет из себя терминал.
* Устройство диагностического интерфейса не использует прерывания
* Устройство диагностического интерфейса может быть реализовано не целиком, а только функция вывода.
* Устройство диагностического интерфейса по умолчанию (если не найдено указанное устройство ввода вывода) преобразуется в базовый tty и используется в операциях ввода вывода (без прерываний) с помощью механизма опроса.


#### Реализация
Для реализации диагностического интерфейса необходимо реализовать структуру 
```C
    struct diag {
    	const struct diag_ops *ops;
    };
```
Функции операций структуры
```
    struct diag_ops {
    	int (*init)(const struct diag *diag);
    	char (*getc)(const struct diag *diag);
    	void (*putc)(const struct diag *diag, char ch);
    	int (*kbhit)(const struct diag *diag);
    };
```
могут быть не все реализованы. Основной функцией является putc которая позволяет выводить на экран с помощью функции kprintf() на очень ранних стадиях загрузки системы.

Пример задания простейшего устройства, позволяющего только осуществлять вывод информации
```
    ...
    static void diag_mem_putc(const struct diag *diag, char ch) {
    ...
    }
    ...
    DIAG_OPS_DEF(
    	.putc = diag_mem_putc,
    );
```

#### Конфигурация
Для задания конфигурации необходимо в модуль embox.driver.diag в качестве параметра передать строчку с названием модуля реализующего драйвер диагнастического устройства. Например:
```
    include embox.driver.diag(impl="embox__driver__serial__i8250")
```

